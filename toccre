import org.docx4j.openpackaging.packages.WordprocessingMLPackage;
import org.docx4j.wml.*;

public class ModifyTOCStyles {
    public static void main(String[] args) throws Exception {
        // Load the .docx file
        WordprocessingMLPackage wordMLPackage = WordprocessingMLPackage.load(new java.io.File("input.docx"));

        // Get the Styles part
        org.docx4j.openpackaging.parts.WordprocessingML.StyleDefinitionsPart stylesPart = wordMLPackage.getMainDocumentPart().getStyleDefinitionsPart();
        Styles styles = stylesPart.getJaxbElement();

        // Modify TOC1 Style (First level of TOC)
        modifyTOCStyle(styles, "TOC1", "Arial", "24", "0000FF", true);

        // Modify TOC2 Style (Second level of TOC)
        modifyTOCStyle(styles, "TOC2", "Calibri", "20", "FF0000", false);

        // Save the modified document
        wordMLPackage.save(new java.io.File("output.docx"));
    }

    private static void modifyTOCStyle(Styles styles, String styleId, String font, String fontSize, String color, boolean bold) {
        for (Style style : styles.getStyle()) {
            if (style.getStyleId().equals(styleId)) {
                // Modify Run Properties (Font, Size, Color, Bold)
                RPr rPr = style.getRPr();
                if (rPr == null) {
                    rPr = new RPr();
                    style.setRPr(rPr);
                }

                // Set font
                RFonts rFonts = new RFonts();
                rFonts.setAscii(font);
                rPr.setRFonts(rFonts);

                // Set font size (Half-points, so multiply by 2)
                HpsMeasure size = new HpsMeasure();
                size.setVal(new java.math.BigInteger(fontSize));
                rPr.setSz(size);

                // Set font color
                Color colorObj = new Color();
                colorObj.setVal(color);
                rPr.setColor(colorObj);

                // Set bold
                if (bold) {
                    BooleanDefaultTrue b = new BooleanDefaultTrue();
                    b.setVal(true);
                    rPr.setB(b);
                } else {
                    rPr.setB(null);
                }
                break;
            }
        }
    }
}
